<div align="center">
  <img alt="ReactJS" title="ReactJS" src="https://github.com/Jordaobm/tests-react/blob/master/src/assets/test.png" width="300px" />
</div>

<br/>
<br/>

[badge-branches]: https://github.com/Jordaobm/tests-react/blob/master/src/assets/badge-branches.svg
[badge-functions]: https://github.com/Jordaobm/tests-react/blob/master/src/assets/badge-functions.svg
[badge-lines]: https://github.com/Jordaobm/tests-react/blob/master/src/assets/badge-lines.svg
[badge-statements]: https://github.com/Jordaobm/tests-react/blob/master/src/assets/badge-statements.svg

![Badge-branches][badge-branches]
![Badge-functions][badge-functions]
![Badge-lines][badge-lines]
![Badge-statements][badge-statements]



<h1>‚öóÔ∏è Testes</h1>

<h2 id="start">üìôSum√°rio</h2>

<ul>
  <li><a href="#sobre">Sobre o reposit√≥rio</a></li>
  <li><a href="#motivo">Por que testes?</a></li>
  <li><a href="#tests">Testes Unit√°rios e de Integra√ß√£o</a></li>
  <li><a href="#testingComponents">Testando componentes</a>
  <li><a href="#testingPages">Testando p√°ginas</a> 
  <li><a href="#playground">Playground de Testes</a>
  <li><a href="#coverage">Coverage Report</a>
  <li><a href="#fim">Considera√ß√µes finais</a>
  <li><a href="#creditos">Cr√©ditos</a>
    
</ul>

<h2 id="sobre">üí° Sobre o reposit√≥rio</h2>
Esse reposit√≥rio tem como objetivo apenas entender e agrupar um conhecimento adquirido durante um m√≥dulo muito interessante do bootcamp ignite da <a href="https://app.rocketseat.com.br/node/testes-unitarios-no-react/group/introducao-7/lesson/testes-no-front-end-tipos-de-testes">Rocketseat üöÄ</a>. O m√≥dulo fala sobre testes no React e a import√¢ncia de escrever testes em nossa aplica√ß√£o. Abaixo segue o conte√∫do estudado durante o m√≥dulo.

<h2 id="motivo">ü§î Por que testes?</h2>

<p>
Escrevemos testes na aplica√ß√£o visando a seguran√ßa na hora da manuten√ß√£o do c√≥digo e tamb√©m realmente testar se a funcionalidade est√° de acordo com o esperado.
</p>


<h2 id="tests">üî® Testes Unit√°rios e de Integra√ß√£o</h2>

<p>
Quando escrevemos uma aplica√ß√£o, geralmente separamos cada parte do nosso c√≥digo em <strong>componentes</strong> menores, pois conforme a necessidade podemos reutilizar esses componentes e tamb√©m deix√°-los em um formato mais leg√≠vel e menos verboso. Quando pensamos em <strong>testes unit√°rios</strong> estamos nos referindo aos testes desses componentes menores e testes focados somente na funcionalidade daquele componente espec√≠fico.
</p>

<p>
<strong>Testes de Integra√ß√£o</strong> s√£o geralmente testes onde conectamos um componente √† outro para validar e testar se o comportamento entre os dois componentes est√° de acordo com o esperado... √© como conectar o formul√°rio de login com o componente que exibe as informa√ß√µes do usu√°rio... depois de fazer login na aplica√ß√£o, o componente que exibe as informa√ß√µes deve exibi-las... esse √© um exemplo de teste de integra√ß√£o
</p>


<h2 id="testingComponents">üë®‚Äçüî¨ Testando componentes</h2>

<p>
Para testar um componente simples da aplica√ß√£o, comecei escrevendo o teste do componente Form. Esse componente √© respons√°vel por um input de textos e um bot√£o que chama uma fun√ß√£o do contexto para executar uma a√ß√£o. Como estamos testando somente o componente Form... come√ßo <strong>mockando</strong> o contexto de onde vem a fun√ß√£o utilizada pelo Form.
</p>

```typescript

import { fireEvent, render, screen } from "@testing-library/react";
import { Video } from "../../context/user";
import { Form } from "./Form";

let videos: Video[] = [];

function handleAddVideo(video: Video) {
  videos = [...videos, video];
}

function mockUseUser() {
  return {
    user: {
      googleId: "116242710850423568991",
      imageUrl:
        "https://lh3.googleusercontent.com/a/AATXAJwxyZDG9G6Vg4NwhfZdHPa4u0EhhBDoWaPEPOT9=s96-c",
      email: "rarius16@gmail.com",
      name: "Olimpo Rarius",
      givenName: "Olimpo",
      familyName: "Rarius",
    },
    handleAddVideo,
    videos,
  };
}

jest.mock("../../context/user", () => {
  return {
    useUser: mockUseUser,
  };
});

```

<p>Depois de mockar os dados, vamos executar algumas a√ß√µes nesse componente Form</p>
<p>Toda vez que escrevo um teste, penso que o primeiro teste a ser feito √© se o componente est√° sendo renderizado em tela corretamente... ent√£o, esse ser√° meu primeiro teste. Nesse teste eu apenas verifico se h√°, na DOM, um elemento input que tenha placeholder ""Digite a url" e id "url"</p>

```typescript

it("should be able to render Form component", () => {
    render(<Form />);

    const input = screen.getAllByPlaceholderText(
      "Digite a url"
    )[0] as HTMLInputElement;

    expect(input?.id).toBe("url");
  });

```

<p>Como segundo e √∫ltimo teste (pois o componente √© muito simples), vamos chamar a a√ß√£o disparada no bot√£o de buscar do componente Form. Nesse teste eu adiciono uma URL no meu input via <strong>fireEvent</strong> e logo em seguida clico no bot√£o... disparando a a√ß√£o de adicionar a url digitada em um array de url's... e √© exatamente isso que eu espero... espero que a minha url tenha sido adicionada no array.</p>


```typescript

it("should be able to search Video by input search", () => {
    render(<Form />);

    const input = screen.getAllByPlaceholderText(
      "Digite a url"
    )[0] as HTMLInputElement;

    const button = screen.getByText("Buscar");

    fireEvent.change(input, {
      target: { value: "https://www.youtube.com/watch?v=pbwXsjVEMqg" },
    });

    fireEvent.click(button);

    expect(videos).toEqual(
      expect.arrayContaining([
        {
          googleId: "116242710850423568991",
          url: "https://www.youtube.com/watch?v=pbwXsjVEMqg",
        },
      ])
    );

    expect(input.value).toBe("");
  });

```

<p>Como √∫ltimo passo dentro dos testes desse componente, eu vou agrupar os testes dentro de um <strong>describe</strong>, e ent√£o na hora de rodar os testes ele tamb√©m ficar√° agrupado por componente testado, melhorando a visualiza√ß√£o posteriormente</p>

```typescript

describe("Form", () => {
  it("should be able to render Form component", () => {
    render(<Form />);

    const input = screen.getAllByPlaceholderText(
      "Digite a url"
    )[0] as HTMLInputElement;

    expect(input?.id).toBe("url");
  });

  it("should be able to search Video by input search", () => {
    render(<Form />);

    const input = screen.getAllByPlaceholderText(
      "Digite a url"
    )[0] as HTMLInputElement;

    const button = screen.getByText("Buscar");

    fireEvent.change(input, {
      target: { value: "https://www.youtube.com/watch?v=pbwXsjVEMqg" },
    });

    fireEvent.click(button);

    expect(videos).toEqual(
      expect.arrayContaining([
        {
          googleId: "116242710850423568991",
          url: "https://www.youtube.com/watch?v=pbwXsjVEMqg",
        },
      ])
    );

    expect(input.value).toBe("");
  });
});


```



<h2 id="testingPages">üìÉ Testando p√°ginas</h2>

<p>Para testar as p√°ginas da aplica√ß√£o, utilizei o mesmo conceito dos testes em componentes. Testes em p√°ginas geralmente j√° entram no quesito de <strong>integra√ß√£o</strong>, pois em uma mesma p√°gina renderizamos v√°rios componentes. Como minha aplica√ß√£o √© bem simples e o foco aqui √© apenas o entendimento b√°sico da escrita inicial de testes, realizei testes apenas de renderiza√ß√£o. Aqui tamb√©m precisei <strong>mockar</strong> o contexto da aplica√ß√£o para que pudessemos testar os v√°rios casos em que os componentes podem estar inseridos</p>

<p>Renderiza√ß√£o da p√°gina sem um usu√°rio logado</p>

```typescript

it("should be able to render Home page", () => {
    render(
      <MemoryRouter>
        <Home />
      </MemoryRouter>
    );

    const container = screen.getByTestId("container") as HTMLDivElement;

    expect(container?.className).toBe("container");
  });

```

<p>Renderiza√ß√£o da p√°gina com um usu√°rio logado</p>

```typescript

it("should be able to render Home page logged user", () => {
    handleSignIn({
      googleId: "116242710850423568991",
      imageUrl:
        "https://lh3.googleusercontent.com/a/AATXAJwxyZDG9G6Vg4NwhfZdHPa4u0EhhBDoWaPEPOT9=s96-c",
      email: "rarius16@gmail.com",
      name: "Olimpo Rarius",
    });

    render(
      <MemoryRouter>
        <Home />
      </MemoryRouter>
    );

    const input = screen.getByPlaceholderText(
      "Digite a url"
    ) as HTMLInputElement;

    expect(input?.id).toBe("url");
  });

```


<h2 id="playground">üõ¥ Playground de Testes</h2>

<p>Quando estivermos realizando testes, uma funcionalidade bem legal da lib <strong>@testing-library/react</strong> √© podermos visualizar em tela os componentes sendo renderizados como est√£o sendo visualizados. Para isso, basta adicionar os seguintes trechos de c√≥digo em seu teste</p>


<p>Importe screen de dentro da lib</p>

```typescript

import { render, screen } from "@testing-library/react";

```

<p>Dentro do seu teste, no final do teste e antes do expect, adicione</p>

```typescript

screen.logTestingPlaygroundURL();

```

<p>Isso dar√° a voc√™ um link direto no console onde est√£o sendo executados os testes para que voc√™ possa visualizar seu compomente/p√°gina</p>



<h2 id="coverage">üìö Coverage Report</h2>

<p>Para saber se sua aplica√ß√£o est√° de fato <strong>coberta por testes</strong>, o <strong>jest</strong> nos d√° a fun√ß√£o de gerar um relat√≥rio de cobertura de c√≥digo, que nos informa tudo sobre nossos testes, desde a quantidade de c√≥digo j√° testada at√© o n√∫mero de vezes que os testes executaram em cada arquivo</p>

<div align="center">
  <img alt="Coverage" title="Coverage" src="https://github.com/Jordaobm/tests-react/blob/master/src/assets/coverage.png" width="100%" />
</div>


<p>E ainda adicionei outra biblioteca que gera alguns SVG's muito legais e √∫teis para esquema de documenta√ß√£o da aplica√ß√£o... a biblioteca √© a <strong>jest-coverage-badges</strong>, e ela gera esses badges aqui</p>

[badge-branches]: https://github.com/Jordaobm/tests-react/blob/master/src/assets/badge-branches.svg
[badge-functions]: https://github.com/Jordaobm/tests-react/blob/master/src/assets/badge-functions.svg
[badge-lines]: https://github.com/Jordaobm/tests-react/blob/master/src/assets/badge-lines.svg
[badge-statements]: https://github.com/Jordaobm/tests-react/blob/master/src/assets/badge-statements.svg

![Badge-branches][badge-branches]
![Badge-functions][badge-functions]
![Badge-lines][badge-lines]
![Badge-statements][badge-statements]


<h2 id="fim">üë∑ Considera√ß√µes finais</h2>

O reposit√≥rio ficar√° guardado com esse conhecimento para que futuramente quando precisarmos, ele estar√° aqui e dispon√≠vel para consulta.

<h2 id="creditos">üë®‚Äçüéì Cr√©ditos</h2>

A todo pessoal da <a href="https://app.rocketseat.com.br/node/testes-unitarios-no-react/group/introducao-7/lesson/testes-no-front-end-tipos-de-testes">Rocketseat üöÄ</a> pelo m√≥dulo super interessante!!!

<a href="#start">üëÜ Voltar ao Sum√°rio</a>

### Autor

---

<a href="https://github.com/Jordaobm" target="_blank">
 <img src="https://avatars.githubusercontent.com/u/70074016?v=4" width="100px;" alt="Jord√£o"/>
 <br />
 <sub><b>Jord√£o Beghetto Massariol</b></sub></a> <a href="https://github.com/Jordaobm" title="Jord√£o">üöÄ</a>

Feito com ‚ù§Ô∏è por Jord√£o Beghetto Massariol üëãüèΩ Entre em contato!

<a href="https://www.linkedin.com/in/jord%C3%A3o-beghetto-massariol-9a9800105/"><img alt="Linkedin" src="https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white"></a>

